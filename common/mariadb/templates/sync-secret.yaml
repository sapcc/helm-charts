{{- if .Values.sync.enabled }}
---
apiVersion: v1
kind: Secret
metadata:
  namespace: {{ $.Release.Namespace }}
  name: {{ include "fullName" . }}-sync-secrets
  labels:
    {{- include "mariadb.labels" (list $ "version" "database-sync" "secret" "opaque") | nindent 4 }}
type: Opaque
data:
  SOURCEDB_PASSWORD: {{ .Values.sync.source.password | required ".Values.sync.source.password is missing" | b64enc | quote }}
  TARGETDB_PASSWORD: {{ .Values.sync.target.password | required ".Values.sync.target.password is missing" | b64enc | quote }}
  OPENSTACK_PASSWORD: {{ .Values.sync.backup.swift.password | required ".Values.sync.backup.swift.password is missing" | b64enc | quote }}
  AWS_ACCESS_KEY_ID: {{ required "missing AWS Access Key ID" $.Values.global.backup_v2.aws_access_key_id | b64enc | quote }}
  AWS_SECRET_ACCESS_KEY: {{ required "missing AWS Secret Access Key" $.Values.global.backup_v2.aws_secret_access_key | b64enc | quote }}
  SSE_CUSTOMER_KEY: {{ required "missing AWS S3 SSE Customer Key" $.Values.global.mariadb.backup_v2.aws.sse_customer_key | b64enc | quote }}
{{- end }}
