{{- if .Values.repoGuard.enabled }}
apiVersion: greenhouse.sap/v1alpha1
kind: Plugin
metadata:
  name: repo-guard-ccloud
  namespace: {{ .Chart.Name }}
  labels:
    greenhouse.sap/owned-by: containers
{{- if .Values.global.fluxEnabled }}
    greenhouse.sap/deployment-tool: "flux"
{{- end }}
  annotations:
    "greenhouse.sap/propagate-labels": "greenhouse.sap/owned-by"
spec:
  pluginDefinition: github-guard
  displayName: {{ required ".Values.repoGuard.displayName missing" .Values.repoGuard.displayName | quote }}
{{ end }}
