{{- if .Values.sapCloudInfrastructure.globalDatasource.enabled }}
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-global-datasource-config
  labels:
    {{ .Values.sapCloudInfrastructure.globalDatasource.label }}: "{{ .Values.sapCloudInfrastructure.globalDatasource.labelValue }}"
data:
  datasource.json: |
    {
      "kind": "GlobalDatasource",
      "metadata": {
        "name": "{{ .Values.sapCloudInfrastructure.globalDatasource.name }}"
      },
      "spec": {
        "display": {
          "name": "{{ .Values.sapCloudInfrastructure.globalDatasource.displayName }}",
          "description": "{{ .Values.sapCloudInfrastructure.globalDatasource.description }}"
        },
        "default": {{ .Values.sapCloudInfrastructure.globalDatasource.default }},
        "plugin": {
          "kind": "PrometheusDatasource",
          "spec": {
            "proxy": {
              "kind": "HTTPProxy",
              "spec": {
                "url": "{{ .Values.sapCloudInfrastructure.globalDatasource.URL }}"
              }
            }
          }
        }
      }
    }
{{- end }}
