{{- range $key, $cluster := .Values.clusters }}
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: greenhouse-manifests-{{ $key }}
  namespace: metal-{{ $key }}
data:
  data: |-
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRoleBinding
    metadata:
      name: greenhouse:system:cluster-admin
    subjects:
      - kind: User
        apiGroup: rbac.authorization.k8s.io
        name: greenhouse:system:serviceaccount:{{ $.Values.controlplane.greenhouseOrg }}:{{ $key }}
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: ClusterRole
      name: cluster-admin
{{- end }}
