{{- range $key, $cluster := .Values.mgmtShoots }}
---
apiVersion: v1
kind: Secret
metadata:
  name: extraignition-cp-{{ $key }}
type: Opaque
stringData:
  ignition: |
    passwd:
      users:
        - name: "{{ printf "{{ resolve `vault+kvv2:///secrets/%s/cc-gardener/nodes/compute-user/username` }}" $key }}"
          password_hash: "{{ printf "{{ resolve `vault+kvv2:///secrets/%s/cc-gardener/nodes/compute-user/passwordHash` }}" $key }}"
          groups: [ "wheel" ]
          ssh_authorized_keys:
            - "{{ printf "{{ resolve `vault+kvv2:///secrets/%s/cc-gardener/nodes/compute-pki/public` }}" $key }}"
{{- end }}
