{{- if .Values.service.enable }}
apiVersion: v1
kind: Service
metadata:
  name: etcd-kcp-backup
  namespace: {{ .Values.namespace | default "kube-system" }}
  labels:
  {{- include "chart.labels" . | nindent 4 }}
spec:
  ports:
    - name: client
      protocol: TCP
      port: 2379
      targetPort: 2379
    - name: server
      protocol: TCP
      port: 2380
      targetPort: 2380
    - name: metrics
      protocol: TCP
      port: 2381
      targetPort: 2381
  selector:
    component: etcd
  clusterIP: None
  clusterIPs:
    - None
  type: ClusterIP
  sessionAffinity: None
  ipFamilies:
    - IPv4
  ipFamilyPolicy: SingleStack
  internalTrafficPolicy: Cluster
{{- end }}
