{{ if not .Values.regions -}}
{{- $shootName := default (printf "met-op-%s" .Values.global.region) .Values.shootName }}
apiVersion: core.gardener.cloud/v1beta1
kind: Shoot
metadata:
  name: {{ $shootName }}
spec:
  cloudProfileName: openstack
  region: {{ required "missing .Values.global.region" .Values.global.region }}
  networking:
    services: 10.55.0.0/16
  provider:
    type: openstack
  kubernetes:
    version: 1.31.5
    kubeAPIServer:
      featureGates:
        AnonymousAuthConfigurableEndpoints: true
      structuredAuthentication:
        configMapName: authentication-config-met-op
{{- end }}
{{- range $region := .Values.regions }}
---
apiVersion: core.gardener.cloud/v1beta1
kind: Shoot
metadata:
  name: met-op-{{ $region }}
spec:
  cloudProfileName: openstack
  region: {{ $region }}
  networking:
    services: 10.55.0.0/16
  provider:
    type: openstack
  kubernetes:
    version: 1.31.5
    kubeAPIServer:
      featureGates:
        AnonymousAuthConfigurableEndpoints: true
      structuredAuthentication:
        configMapName: authentication-config-met-op
  seedSelector:
    matchLabels:
      name.seed.gardener.cloud/soil-{{ $region }}: "true"
{{- end }}
