{{ $envAll := . }}
{{- $cells := list "cell1" }}
{{- if .Values.cell2.enabled }}
  {{ $cells = append $cells .Values.cell2.name }}
{{- end }}
{{- range $cell_name := $cells }}
{{- with $envAll }}
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: nova-console-{{ $cell_name }}-mks
  labels:
    system: openstack
    type: configuration
    component: nova
data:
{{ (.Files.Glob "console/mks/*").AsConfig | indent 2 }}
{{ (.Files.Glob "console/common/*").AsConfig | indent 2 }}
{{- end }}
{{- end }}
