apiVersion: v1
kind: Secret
metadata:
  name: nova-etc
  labels:
    system: openstack
    type: configuration
    component: nova
stringData:
  db.conf: |
    {{- include "nova.helpers.ini_sections.api_database" . | indent 4 }}

    {{- include "ini_sections.database" . | indent 4 }}
  cell1.conf: |
    [DEFAULT]
    {{- include "ini_sections.default_transport_url" . | indent 4 }}

    [database]
    connection = {{ include "db_url_mysql" . }}
  {{- if .Values.cell2.enabled }}
  {{ .Values.cell2.name }}.conf: |
    [DEFAULT]
    transport_url = {{ include "cell2_transport_url" . }}

    [database]
    connection = {{ include "cell2_db_path" . }}
  {{- end }}
