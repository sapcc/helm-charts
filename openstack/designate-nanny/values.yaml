owner-info:
  helm-chart-url: https://github.com/sapcc/helm-charts/tree/master/openstack/designate-nanny
  service: designate
  support-group: network-api
  maintainers:
    - Florian Streibelt
    - Dmitry Galkin
    - David Hoeller

image:
  name: designate-nanny
  # image_tag: ""

resources:
  requests:
    memory: "256Mi"
    cpu: "100m"
  limits:
    memory: "1Gi"
    cpu: "800m"

nanny_enabled: false
nanny_oor_enabled: false

global:
  linkerd_requested: false # overwritten in regions where enabled
  is_global_region: false

seed_users: False
# defined in secrets:
#users:
#  seed_only_user:
#    # this user is seeded to allow another region accessing the
#    # openstack/designate API to get zones and zone transfers
#    seed_enabled: True
#    username: "vault+kvv2:///..."
#    password: "vault+kvv2:///..."
#    user_domain: UserDomain
#    project_name: UserProject
#    project_domain_name: ProjectDomain
#    roles:
#      SomeDomain:
#        SomeProjectA:
#          - cloud_dns_backup
#        SomeProjectB::
#          - objectstore_admin
#
#  local_user:
#    # this user is used to locally (in this region) access openstack,
#    # both designate and swift, to do local backups.
#    seed_enabled: True
#
#  remote_user:
#    # this user is not seeded here, but in the remot region, like the
#    # seed_only_user above. It only needs permission to access designate
#    seed_enabled: False
#    ...
#    -> definitions like above, but without roles.

designate_nanny:
# defined in secrets:
#  users:
#    openstack: local_user

  config:
    global:
      # see example nanny.yaml config in
      # https://github.wdf.sap.corp/cc/dns-docker/tree/main/designate-nanny
      #
      # note: global settings only come into
      # effect, if not overriden in the specific subsections,
      # except for "dryrun" to 'fail to the secure side'
      # on conflicting settings
      #
      # all nanny plugings with autorun enabled will be run by the nanny
      # when the nanny is called with this config and the autorun command,
      # autorun also has to be enabled globally, to prevent accidental autorun
      # when using the nanny locally with a user config
      #
      dryrun: false       # do not change anything unless set in region otherwise
      autorun: true        # globally enable autorun feature
      enabled: true        # globally enable nanny
      loglevel: "INFO"
      oneshot: false       # terminate after one run (when deploying as job)
      mdns_endpoint: auto # will be set in values per region
    swift_backup:
      interval: 1h
      record_lastrun: true
      # defined in secrets:
      # swift:
        # autorun: true/false   # run this nanny plugin in autorun
        # enabled: true/false   # enable/disable this plugin
        # container:
        # prefix:
        # project_domain_name:
        # project_name:

# for the out of region backup, if enabled:
#
designate_nanny_oor:
# defined in secrets:
#  users:
#    openstack: remote_user  <<- point to user in REMOTE region
#    swift: local_user      <<- point to user in LOCAL region

  config:
    global:
      dryrun: false       # do not change anything unless set in region otherwise
      autorun: true       # globally enable autorun feature
      enabled: true       # globally enable nanny
      loglevel: "INFO"
      oneshot: false      # terminate after one run (when deploying as job)
      mdns_endpoint: auto # <<- point to the REMOTE region!

    swift_backup:
      interval: 1h
      record_lastrun: true
      # defined in secrets
      # swift:
        # autorun: true/false   # run this nanny plugin in autorun
        # enabled: true/false   # enable/disable this plugin
        # region:   <<- should point to the local region
        # auth_url: <<- should point to the local region
        # container:
        # prefix:
        # project_domain_name:
        # project_name:
