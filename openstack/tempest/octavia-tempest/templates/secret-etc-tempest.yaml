{{- if (index .Values (print .Chart.Name | replace "-" "_")).tempest.enabled}}
apiVersion: v1
kind: Secret
metadata:
  name: {{ .Chart.Name }}-etc-secret
  labels:
    system: openstack
    type: configuration
type: Opaque
data:
  tempest_accounts.yaml: |
{{ include (print .Template.BasePath "/etc/_tempest_accounts.yaml.tpl") . | b64enc | indent 4 }}
  tempest_deployment_config.json: |
{{ include (print .Template.BasePath "/etc/_tempest_deployment_config.json.tpl") . | b64enc | indent 4 }}
  tempest_extra_options: |
{{ include (print .Template.BasePath "/etc/_tempest_extra_options.tpl") . | b64enc  | indent 4 }}
  OS_PASSWORD: {{ .Values.tempestAdminPassword | b64enc }}
{{ end }}
