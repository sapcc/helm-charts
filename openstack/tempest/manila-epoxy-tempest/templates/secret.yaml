{{- if (index .Values (print .Chart.Name | replace "-" "_")).tempest.enabled}}
apiVersion: v1
kind: Secret
metadata:
  name: {{ .Chart.Name }}-secret
  labels:
    app: {{ .Chart.Name }}
    chart: "{{ .Chart.Name }}-{{ .Chart.Version }}"
    release: "{{ .Release.Name }}"
    heritage: "{{ .Release.Service }}"
    component: tempest
    type: config
type: Opaque
stringData:
  tempest-admin-password: {{ .Values.tempestAdminPassword | quote }}
  tempest_accounts.yaml: |
{{ include (print .Template.BasePath "/etc/_tempest_accounts.yaml.tpl") . | indent 4 }}
  tempest_deployment_config.json: |
{{ include (print .Template.BasePath "/etc/_tempest_deployment_config.json.tpl") . | indent 4 }}
  tempest_extra_options: |
{{ include (print .Template.BasePath "/etc/_tempest_extra_options.tpl") . | indent 4 }}
{{- end }}
